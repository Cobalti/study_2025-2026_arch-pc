---
title: "Лабораторная работа №5"
author: 
  - name: "[Галиев Самир Салаватович]"
    email: "[1032252590@rudn.ru]"
    stud_id: "[1032252590]"
  - name: "Российский университет дружбы народов"
    country: "Россия"
    city: "Москва"
date: "25.10.2025"
geometry:
  - left=3cm
  - right=1.5cm
  - top=2cm
  - bottom=2cm
fontsize: 13pt
linestretch: 1.5
indent: true
---
# Лабораторная работа №5. Основы работы с Midnight Commander. Структура программы на языке ассемблера NASM.
### Выполнил: [Галиев Самир Салаватович]
### Группа: [НКАбд-02-25]
### Дата выполнения: [08.11.2025]

#### Оглавление:
#### 1.Цель работы
#### 2.Результаты выполнения лабораторной работы
####   2.1 Работа с Midnight Commander
####   2.2 Создание и выполнение первой программы
####   2.3 Работа с внешним файлом in_out.asm
#### 3.Задание для самостоятельной работы
####   3.1 Модификация программы без in_out.asm
####   3.2 Модификация программы с in_out.asm
#### 4.Выводы
#### 5.Листинги программ
#### 6.Список литературы

##### 1.Цель работы
Приобретение практических навыков работы в Midnight Commander. Освоение инструкций языка ассемблера mov и int.

##### 2.Результаты выполнения лабораторной работы
##### 2.1.Работа с Midnight Commander
**Задание**: Изучение основ работы с файловым менеджером Midnight Commander, создание рабочего каталога и навигация по файловой системе.
Выполнение:
1)Запущен Midnight Commander командой mc
Создан каталог lab05 в директории ~/work/arch-pc с помощью клавиши F7
Осуществлена навигация по файловой системе с использованием клавиш ↑, ↓ и Enter
!()[image/step1.png]

**Комментарии**: Midnight Commander предоставляет удобный графический интерфейс для работы с файловой системой, позволяя выполнять основные операции управления файлами с помощью функциональных клавиш.

Создание и выполнение первой программы
Задание: Создание программы на языке ассемблера NASM для вывода сообщения на экран и ввода строки с клавиатуры с использованием системных вызовов.

Выполнение:

Создан файл lab5-1.asm командой touch

Написан код программы с использованием системных вызовов write, read и exit

Программа оттранслирована и скомпонована:

bash
nasm -f elf32 lab5-1.asm
ld -m elf_i386 -o lab5-1 lab5-1.o
Программа запущена и протестирована

https://screenshots/lab5-1_code.png

https://screenshots/lab5-1_run.png

Комментарии: Программа успешно выводит приглашение для ввода строки и ожидает пользовательский ввод. Использованы системные вызовы через инструкцию int 0x80 с передачей параметров через регистры.

Работа с внешним файлом in_out.asm
Задание: Подключение внешнего файла с подпрограммами и модификация программы для использования этих подпрограмм.

Выполнение:

Скачан файл in_out.asm и скопирован в рабочий каталог

Создана копия программы lab5-2.asm

Программа модифицирована для использования подпрограмм sprintLF, sread и quit

Проведено сравнение работы подпрограмм sprint и sprintLF

https://screenshots/in_out_copy.png

https://screenshots/sprint_comparison.png

Комментарии: Подпрограмма sprintLF добавляет символ перевода строки после вывода сообщения, в то время как sprint выводит сообщение без перевода строки. Использование внешних подпрограмм упрощает написание кода и делает его более читаемым.

Задание для самостоятельной работы
Модификация программы без in_out.asm
Задание: Модификация программы lab5-1.asm для вывода введенной строки обратно на экран без использования внешнего файла in_out.asm.

Выполнение:

Создана копия файла lab5-3.asm

Добавлен системный вызов write после вызова read для вывода введенной строки

Программа собрана и протестирована

https://screenshots/lab5-3_run.png

Комментарии: Для вывода введенной строки использован системный вызов write с передачей адреса буфера и длины введенной строки. Длина строки сохраняется из регистра eax после системного вызова read.

Модификация программы с in_out.asm
Задание: Модификация программы lab5-2.asm для вывода введенной строки обратно на экран с использованием подпрограмм из файла in_out.asm.

Выполнение:

Создана копия файла lab5-4.asm

Добавлен вызов подпрограммы sprintLF после ввода строки для ее вывода на экран

Программа собрана и протестирована

https://screenshots/lab5-4_run.png

Комментарии: Использование подпрограмм из внешнего файла значительно упрощает код основной программы. Подпрограмма sprintLF автоматически обрабатывает вывод строки с переводом строки.

Выводы
В ходе выполнения лабораторной работы были достигнуты следующие результаты:


Освоена работа с Midnight Commander: Приобретены практические навыки навигации по файловой системе, создания каталогов и файлов с использованием функциональных клавиш файлового менеджера.

Изучена структура программ на NASM: Освоено создание программ с тремя основными секциями (.data, .bss, .text) и использование директив для объявления данных.

Освоены инструкции mov и int: Изучены различные варианты использования инструкции mov с разными типами операндов и применение инструкции int 0x80 для системных вызовов.

Реализован диалог с пользователем: Созданы программы, осуществляющие вывод сообщений на экран и ввод данных с клавиатуры с использованием системных вызовов write и read.

Освоена работа с внешними файлами: Изучено подключение и использование внешних файлов с подпрограммами, что позволяет создавать более структурированный и читаемый код.

Выполнены задания для самостоятельной работы: Успешно модифицированы программы для вывода введенной строки обратно на экран как с использованием системных вызовов напрямую, так и через внешние подпрограммы.

Цель работы - приобретение практических навыков работы в Midnight Commander и освоение инструкций языка ассемблера mov и int - достигнута полностью.

#### Листинги программ
##### lab5-1.asm
```
SECTION .data
    msg: DB 'Введите строку:',10
    msgLen: EQU $-msg

SECTION .bss
    buf1: RESB 80

SECTION .text
    GLOBAL _start

_start:
    mov eax, 4
    mov ebx, 1
    mov ecx, msg
    mov edx, msgLen
    int 0x80

    mov eax, 3
    mov ebx, 0
    mov ecx, buf1
    mov edx, 80
    int 0x80

    mov eax, 1
    mov ebx, 0
    int 0x80
```
##### lab5-2.asm
```
%include 'in_out.asm'

SECTION .data
    msg: DB 'Введите строку: ',0h

SECTION .bss
    buf1: RESB 80

SECTION .text
    GLOBAL _start

_start:
    mov eax, msg
    call sprintLF

    mov ecx, buf1
    mov edx, 80
    call sread

    call quit
```
##### lab5-3.asm
``
SECTION .data
    msg: DB 'Введите строку:',10
    msgLen: EQU $-msg

SECTION .bss
    buf1: RESB 80

SECTION .text
    GLOBAL _start

_start:
    mov eax, 4
    mov ebx, 1
    mov ecx, msg
    mov edx, msgLen
    int 0x80

    mov eax, 3
    mov ebx, 0
    mov ecx, buf1
    mov edx, 80
    int 0x80

    mov edx, eax
    mov eax, 4
    mov ebx, 1
    mov ecx, buf1
    int 0x80

    mov eax, 1
    mov ebx, 0
    int 0x80
``
##### lab5-4.asm
``
%include 'in_out.asm'

SECTION .data
    msg: DB 'Введите строку: ',0h

SECTION .bss
    buf1: RESB 80

SECTION .text
    GLOBAL _start

_start:
    mov eax, msg
    call sprintLF

    mov ecx, buf1
    mov edx, 80
    call sread

    mov eax, buf1
    call sprintLF

    call quit
``
##### in_out.asm
``
sprint:
    push    edx
    push    ecx
    push    ebx
    push    eax
    call    slen

    mov     edx, eax
    pop     eax

    mov     ecx, eax
    mov     ebx, 1
    mov     eax, 4
    int     80h

    pop     ebx
    pop     ecx
    pop     edx
    ret

slen:
    push    ebx
    mov     ebx, eax

nextchar:
    cmp     byte [eax], 0
    jz      finished
    inc     eax
    jmp     nextchar

finished:
    sub     eax, ebx
    pop     ebx
    ret

sprintLF:
    call    sprint

    push    eax
    mov     eax, 0Ah
    push    eax
    mov     eax, esp
    call    sprint
    pop     eax
    pop     eax
    ret

sread:
    push    ecx
    push    edx
    push    ebx
    push    eax

    mov     eax, 3
    mov     ebx, 0
    mov     ecx, buf
    mov     edx, bufSize
    int     80h

    pop     eax
    pop     ebx
    pop     edx
    pop     ecx
    ret

quit:
    mov     ebx, 0
    mov     eax, 1
    int     80h
    ret

SECTION .bss
    buf     resb    256
    bufSize equ     $-buf
``
#### Список литературы
1) Midnight Commander Development Center. — 2021. — URL: https://midnight-commander.org/
2) NASM Assembly Language Tutorials. — 2021. — URL: https://asmtutor.com/
3) The NASM documentation. — 2021. — URL: https://www.nasm.us/docs.php
4) Расширенный ассемблер: NASM. — 2021. — URL: https://www.opennet.ru/docs/RUS/nasm/
5) Столяров А. Программирование на языке ассемблера NASM для OC Unix. — 2-е изд. — М. : MAKC Пресс, 2011. — URL: http://www.stolyarov.info/books/asm_unix


